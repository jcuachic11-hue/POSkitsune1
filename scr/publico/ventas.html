<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Módulo de Ventas</title>
    <script>
        const token = localStorage.getItem('token'); // reutilizamos el JWT guardado

        async function agregarCarrito() {
            const idProducto = document.getElementById('idProducto').value;
            const cantidad = document.getElementById('cantidad').value;

            const res = await fetch('/ventas/carrito', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                },
                body: JSON.stringify({ idProducto, cantidad })
            });
            const data = await res.json();
            document.getElementById('resultado').innerText = JSON.stringify(data, null, 2);
        }

        async function listarCarrito() {
            const res = await fetch('/ventas/carrito', {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            const data = await res.json();
            document.getElementById('resultado').innerText = JSON.stringify(data, null, 2);
        }

        async function verTotales() {
            const res = await fetch('/ventas/totales', {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            const data = await res.json();
            document.getElementById('resultado').innerText = JSON.stringify(data, null, 2);
        }

        async function comprar() {
            const res = await fetch('/ventas/comprar', {
                method: 'POST',
                headers: { 'Authorization': `Bearer ${token}` }
            });
            const data = await res.json();
            document.getElementById('resultado').innerText = JSON.stringify(data, null, 2);
        }
    </script>
</head>
<body>
    <h1>Módulo de Ventas</h1>

    <h2>Agregar producto al carrito</h2>
    <label>ID Producto:</label>
    <input type="text" id="idProducto">
    <label>Cantidad:</label>
    <input type="number" id="cantidad" value="1">
    <button onclick="agregarCarrito()">Agregar</button>

    <h2>Carrito</h2>
    <button onclick="listarCarrito()">Ver Carrito</button>

    <h2>Totales</h2>
    <button onclick="verTotales()">Ver Totales</button>

    <h2>Comprar</h2>
    <button onclick="comprar()">Comprar</button>

    <pre id="resultado"></pre>
</body>
</html>

